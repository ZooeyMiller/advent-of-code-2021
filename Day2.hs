main = do
  let finalPosition = foldl (\x y -> updatePosition y x) initialPosition values
  putStrLn $ show $ finalPosition
  putStrLn $ show $ getPositionRes finalPosition

  -- Had an issue here where I was originally using foldr, which caused issues
  -- with aim, updating to foldl sorted, works for both
  let finalPositionWithAim = foldl (\x y -> updatePositionWithAim y x) initialPositionWithAim values
  putStrLn $ show $ finalPositionWithAim
  putStrLn $ show $ getPositionWithAimRes finalPositionWithAim

-- from 1st part
data Direction
  = Forward Int
  | Up Int
  | Down Int
  deriving (Show, Eq)

data Depth = Depth Int deriving (Show, Eq)

data Horizontal = Horizontal Int deriving (Show, Eq)

data Position = Position Horizontal Depth deriving (Show, Eq)

addToHorizontal :: Direction -> Horizontal -> Horizontal
addToHorizontal (Forward x) (Horizontal y) = Horizontal (y + x)
addToHorizontal _ res = res

addToDepth :: Direction -> Depth -> Depth
addToDepth (Up x) (Depth y) = Depth (y - x)
addToDepth (Down x) (Depth y) = Depth (y + x)
addToDepth _ res = res

updatePosition :: Direction -> Position -> Position
updatePosition direction (Position hor depth) =
  Position (addToHorizontal direction hor) (addToDepth direction depth)

getPositionRes :: Position -> Int
getPositionRes (Position (Horizontal x) (Depth y)) = x * y

initialPosition = Position (Horizontal 0) (Depth 0)

-- second part

data Aim = Aim Int deriving (Show, Eq)

data PositionWithAim = PositionWithAim Horizontal Depth Aim deriving (Show, Eq)

initialPositionWithAim = PositionWithAim (Horizontal 0) (Depth 0) (Aim 0)

updatePositionWithAim :: Direction -> PositionWithAim -> PositionWithAim
updatePositionWithAim (Up x) (PositionWithAim a b (Aim c)) =
  PositionWithAim a b (Aim $ c - x)
updatePositionWithAim (Down x) (PositionWithAim a b (Aim c)) =
  PositionWithAim a b (Aim $ c + x)
updatePositionWithAim (Forward x) (PositionWithAim (Horizontal a) (Depth b) (Aim c)) =
  PositionWithAim (Horizontal $ a + x) (Depth $ b + (x * c)) (Aim c)

getPositionWithAimRes :: PositionWithAim -> Int
getPositionWithAimRes (PositionWithAim (Horizontal x) (Depth y) _) = x * y

values =
  [ Forward 1,
    Down 3,
    Down 2,
    Up 1,
    Down 7,
    Down 8,
    Forward 6,
    Forward 1,
    Forward 1,
    Down 6,
    Up 3,
    Down 7,
    Down 1,
    Down 6,
    Forward 6,
    Down 6,
    Forward 3,
    Up 7,
    Forward 5,
    Down 4,
    Forward 6,
    Forward 1,
    Forward 6,
    Forward 9,
    Forward 3,
    Up 1,
    Forward 7,
    Down 9,
    Forward 2,
    Up 9,
    Down 5,
    Down 3,
    Up 1,
    Down 6,
    Down 7,
    Down 8,
    Down 7,
    Forward 7,
    Forward 3,
    Down 5,
    Down 2,
    Forward 4,
    Forward 7,
    Down 8,
    Down 4,
    Down 5,
    Down 1,
    Forward 4,
    Up 6,
    Forward 6,
    Forward 4,
    Forward 5,
    Up 3,
    Up 6,
    Down 4,
    Down 8,
    Forward 4,
    Forward 5,
    Down 3,
    Forward 1,
    Down 5,
    Down 5,
    Forward 8,
    Forward 9,
    Forward 1,
    Forward 8,
    Forward 5,
    Forward 6,
    Up 8,
    Down 3,
    Forward 8,
    Up 2,
    Down 3,
    Down 9,
    Up 9,
    Forward 5,
    Down 2,
    Forward 7,
    Forward 5,
    Forward 5,
    Down 2,
    Down 3,
    Forward 7,
    Forward 9,
    Down 9,
    Forward 3,
    Forward 3,
    Down 3,
    Forward 3,
    Up 6,
    Down 4,
    Forward 3,
    Forward 3,
    Forward 7,
    Down 4,
    Forward 8,
    Up 8,
    Down 3,
    Down 2,
    Forward 2,
    Down 6,
    Down 6,
    Up 7,
    Up 9,
    Down 4,
    Up 7,
    Up 8,
    Down 6,
    Down 1,
    Forward 6,
    Forward 9,
    Forward 1,
    Forward 8,
    Down 4,
    Up 3,
    Forward 6,
    Down 5,
    Forward 7,
    Forward 5,
    Down 2,
    Forward 7,
    Down 6,
    Forward 7,
    Up 2,
    Up 5,
    Forward 3,
    Down 6,
    Down 9,
    Down 9,
    Forward 9,
    Up 7,
    Down 6,
    Down 4,
    Down 8,
    Forward 6,
    Up 6,
    Down 2,
    Forward 5,
    Up 7,
    Forward 5,
    Down 1,
    Up 8,
    Forward 2,
    Forward 4,
    Down 5,
    Down 8,
    Up 7,
    Up 5,
    Down 2,
    Forward 8,
    Forward 4,
    Up 6,
    Forward 8,
    Down 3,
    Down 2,
    Down 2,
    Forward 4,
    Forward 2,
    Forward 9,
    Up 3,
    Up 7,
    Up 3,
    Up 5,
    Forward 5,
    Up 8,
    Forward 3,
    Forward 1,
    Down 3,
    Down 8,
    Forward 6,
    Forward 5,
    Up 5,
    Down 9,
    Down 1,
    Down 9,
    Forward 9,
    Up 3,
    Forward 7,
    Forward 6,
    Forward 1,
    Up 3,
    Forward 9,
    Forward 7,
    Down 9,
    Up 6,
    Forward 2,
    Up 9,
    Forward 6,
    Forward 4,
    Up 3,
    Forward 5,
    Down 4,
    Up 8,
    Up 4,
    Up 9,
    Down 1,
    Down 7,
    Forward 7,
    Forward 2,
    Down 9,
    Forward 7,
    Forward 2,
    Down 6,
    Down 9,
    Up 6,
    Down 7,
    Down 2,
    Down 7,
    Down 6,
    Down 4,
    Down 4,
    Forward 6,
    Forward 9,
    Forward 4,
    Down 7,
    Down 5,
    Up 6,
    Down 7,
    Forward 2,
    Down 3,
    Down 1,
    Forward 1,
    Forward 5,
    Down 4,
    Down 4,
    Down 1,
    Down 9,
    Forward 6,
    Down 3,
    Forward 5,
    Up 7,
    Forward 9,
    Down 8,
    Down 3,
    Up 2,
    Up 2,
    Forward 4,
    Down 7,
    Forward 2,
    Forward 5,
    Forward 4,
    Forward 3,
    Down 8,
    Down 6,
    Forward 9,
    Down 1,
    Forward 1,
    Down 1,
    Up 8,
    Down 2,
    Forward 2,
    Up 5,
    Down 7,
    Forward 8,
    Down 7,
    Down 4,
    Forward 2,
    Forward 6,
    Up 2,
    Forward 8,
    Forward 2,
    Forward 1,
    Up 5,
    Down 4,
    Down 8,
    Forward 4,
    Down 8,
    Up 8,
    Forward 3,
    Down 5,
    Forward 2,
    Forward 1,
    Up 3,
    Forward 9,
    Up 5,
    Forward 5,
    Forward 5,
    Up 8,
    Down 6,
    Forward 3,
    Down 4,
    Up 5,
    Forward 3,
    Up 6,
    Forward 6,
    Forward 9,
    Down 7,
    Down 7,
    Down 8,
    Down 4,
    Forward 4,
    Forward 3,
    Forward 3,
    Forward 5,
    Down 3,
    Forward 8,
    Up 5,
    Forward 1,
    Up 7,
    Down 5,
    Forward 7,
    Forward 3,
    Down 3,
    Forward 2,
    Forward 1,
    Forward 4,
    Up 2,
    Down 8,
    Forward 9,
    Forward 9,
    Down 6,
    Down 1,
    Down 5,
    Forward 4,
    Down 2,
    Forward 1,
    Up 7,
    Down 9,
    Forward 3,
    Down 5,
    Down 5,
    Up 6,
    Down 6,
    Forward 8,
    Down 1,
    Up 3,
    Down 2,
    Up 1,
    Forward 5,
    Down 4,
    Down 6,
    Forward 8,
    Down 4,
    Down 5,
    Down 2,
    Forward 5,
    Forward 8,
    Down 8,
    Up 4,
    Forward 2,
    Up 2,
    Down 9,
    Forward 6,
    Forward 1,
    Forward 5,
    Up 2,
    Down 1,
    Up 7,
    Up 3,
    Forward 3,
    Down 7,
    Forward 2,
    Forward 4,
    Up 7,
    Forward 4,
    Forward 6,
    Up 2,
    Forward 4,
    Forward 2,
    Down 6,
    Down 5,
    Down 5,
    Down 6,
    Forward 9,
    Up 4,
    Down 4,
    Down 7,
    Up 6,
    Up 9,
    Up 4,
    Down 4,
    Up 7,
    Down 9,
    Down 9,
    Forward 3,
    Down 7,
    Down 7,
    Down 7,
    Down 2,
    Up 2,
    Up 1,
    Up 6,
    Down 8,
    Up 7,
    Down 4,
    Forward 8,
    Down 7,
    Up 1,
    Down 5,
    Down 3,
    Forward 6,
    Up 1,
    Down 5,
    Forward 3,
    Forward 6,
    Forward 7,
    Forward 2,
    Down 3,
    Forward 1,
    Up 9,
    Down 5,
    Up 2,
    Up 9,
    Up 2,
    Up 2,
    Forward 1,
    Down 2,
    Forward 1,
    Down 7,
    Forward 1,
    Forward 8,
    Down 9,
    Down 1,
    Forward 9,
    Forward 7,
    Forward 7,
    Down 5,
    Down 5,
    Down 3,
    Forward 6,
    Down 7,
    Down 4,
    Forward 2,
    Up 6,
    Down 3,
    Up 4,
    Up 7,
    Forward 2,
    Forward 8,
    Forward 4,
    Down 7,
    Down 9,
    Up 1,
    Down 2,
    Up 8,
    Down 2,
    Up 6,
    Forward 6,
    Up 5,
    Down 2,
    Forward 5,
    Down 4,
    Forward 7,
    Down 3,
    Down 5,
    Forward 1,
    Down 7,
    Forward 1,
    Up 1,
    Forward 4,
    Up 4,
    Forward 4,
    Forward 5,
    Forward 7,
    Down 7,
    Down 2,
    Up 4,
    Down 2,
    Down 3,
    Forward 3,
    Forward 2,
    Forward 5,
    Forward 2,
    Up 8,
    Forward 3,
    Down 7,
    Down 9,
    Forward 3,
    Forward 6,
    Down 7,
    Down 5,
    Down 3,
    Up 3,
    Forward 5,
    Forward 2,
    Down 1,
    Up 1,
    Up 8,
    Down 6,
    Down 4,
    Down 1,
    Forward 1,
    Down 7,
    Up 8,
    Forward 2,
    Forward 8,
    Forward 8,
    Forward 7,
    Down 1,
    Forward 8,
    Down 8,
    Forward 4,
    Down 3,
    Up 9,
    Down 8,
    Forward 9,
    Down 7,
    Up 2,
    Forward 9,
    Down 4,
    Up 3,
    Up 4,
    Up 4,
    Forward 5,
    Up 2,
    Forward 3,
    Down 5,
    Forward 5,
    Down 5,
    Up 8,
    Down 4,
    Forward 6,
    Down 6,
    Forward 7,
    Forward 2,
    Down 2,
    Up 7,
    Down 5,
    Down 9,
    Down 8,
    Down 4,
    Up 3,
    Forward 4,
    Down 8,
    Down 8,
    Down 9,
    Down 7,
    Forward 2,
    Forward 8,
    Up 5,
    Forward 8,
    Down 9,
    Forward 6,
    Up 1,
    Down 6,
    Forward 1,
    Up 4,
    Down 3,
    Forward 3,
    Forward 2,
    Down 6,
    Forward 7,
    Up 6,
    Up 9,
    Down 1,
    Forward 3,
    Forward 4,
    Forward 2,
    Up 8,
    Forward 9,
    Up 7,
    Down 2,
    Forward 2,
    Up 7,
    Down 2,
    Up 6,
    Down 2,
    Forward 9,
    Forward 3,
    Down 6,
    Down 5,
    Down 3,
    Forward 9,
    Down 8,
    Down 8,
    Down 2,
    Down 7,
    Up 3,
    Forward 1,
    Down 7,
    Up 8,
    Up 8,
    Forward 5,
    Forward 5,
    Forward 1,
    Down 8,
    Down 6,
    Forward 2,
    Up 3,
    Forward 1,
    Forward 7,
    Forward 4,
    Forward 5,
    Forward 9,
    Forward 7,
    Forward 6,
    Forward 3,
    Forward 4,
    Down 8,
    Down 1,
    Forward 6,
    Forward 9,
    Forward 6,
    Forward 9,
    Forward 6,
    Up 3,
    Down 8,
    Forward 4,
    Forward 1,
    Down 4,
    Forward 9,
    Down 8,
    Down 3,
    Up 2,
    Forward 5,
    Forward 2,
    Forward 5,
    Down 6,
    Down 3,
    Up 1,
    Down 9,
    Up 5,
    Forward 6,
    Down 7,
    Forward 1,
    Forward 9,
    Down 2,
    Down 5,
    Forward 3,
    Forward 6,
    Down 4,
    Down 5,
    Up 4,
    Forward 7,
    Forward 5,
    Down 8,
    Forward 6,
    Down 5,
    Forward 2,
    Down 7,
    Forward 4,
    Forward 8,
    Down 8,
    Forward 2,
    Forward 8,
    Down 5,
    Forward 7,
    Down 8,
    Down 1,
    Forward 8,
    Down 4,
    Up 4,
    Down 7,
    Down 6,
    Up 5,
    Forward 4,
    Forward 1,
    Forward 4,
    Down 5,
    Forward 5,
    Forward 9,
    Down 1,
    Forward 3,
    Up 7,
    Down 1,
    Down 7,
    Forward 2,
    Down 5,
    Down 6,
    Forward 5,
    Up 2,
    Down 9,
    Forward 1,
    Up 5,
    Forward 6,
    Forward 9,
    Forward 4,
    Up 4,
    Down 6,
    Up 9,
    Up 5,
    Down 2,
    Up 9,
    Down 2,
    Down 4,
    Down 8,
    Down 2,
    Forward 2,
    Forward 2,
    Down 9,
    Up 5,
    Forward 2,
    Forward 8,
    Down 2,
    Down 2,
    Down 9,
    Down 3,
    Down 9,
    Up 9,
    Up 3,
    Down 1,
    Down 9,
    Down 2,
    Forward 7,
    Down 2,
    Up 3,
    Down 9,
    Up 2,
    Up 4,
    Forward 5,
    Forward 7,
    Down 7,
    Up 7,
    Up 5,
    Down 8,
    Up 2,
    Forward 2,
    Down 3,
    Down 5,
    Forward 2,
    Forward 3,
    Forward 3,
    Down 1,
    Down 1,
    Forward 9,
    Down 5,
    Down 7,
    Forward 7,
    Forward 5,
    Up 9,
    Forward 3,
    Up 4,
    Forward 1,
    Forward 3,
    Down 4,
    Forward 9,
    Down 5,
    Down 3,
    Down 5,
    Forward 6,
    Down 6,
    Forward 2,
    Up 4,
    Down 4,
    Forward 2,
    Down 8,
    Up 9,
    Forward 9,
    Forward 4,
    Down 8,
    Forward 2,
    Forward 5,
    Forward 1,
    Forward 5,
    Up 1,
    Forward 7,
    Forward 9,
    Down 5,
    Forward 6,
    Down 1,
    Forward 6,
    Down 2,
    Forward 9,
    Down 1,
    Forward 1,
    Down 4,
    Down 6,
    Down 2,
    Up 7,
    Up 5,
    Forward 8,
    Forward 1,
    Down 8,
    Forward 1,
    Forward 2,
    Down 8,
    Forward 7,
    Down 5,
    Forward 1,
    Down 2,
    Up 7,
    Forward 7,
    Down 4,
    Down 8,
    Up 6,
    Up 4,
    Forward 7,
    Down 3,
    Up 5,
    Down 5,
    Forward 7,
    Up 7,
    Down 6,
    Forward 8,
    Down 7,
    Down 2,
    Up 3,
    Down 9,
    Down 7,
    Down 8,
    Forward 4,
    Forward 3,
    Forward 9,
    Forward 6,
    Up 7,
    Forward 5,
    Down 4,
    Down 5,
    Forward 6,
    Up 9,
    Down 6,
    Down 7,
    Down 8,
    Down 9,
    Down 4,
    Up 5,
    Down 4,
    Forward 5,
    Forward 3,
    Down 3,
    Down 7,
    Up 8,
    Forward 5,
    Down 8,
    Down 1,
    Down 6,
    Down 9,
    Up 4,
    Up 1,
    Down 8,
    Down 3,
    Down 8,
    Up 4,
    Down 7,
    Down 6,
    Forward 7,
    Up 9,
    Down 4,
    Down 1,
    Down 6,
    Down 2,
    Forward 7,
    Down 2,
    Down 7,
    Forward 3,
    Forward 6,
    Up 2,
    Down 4,
    Up 1,
    Forward 4,
    Up 2,
    Down 4,
    Up 3,
    Down 8,
    Up 9,
    Forward 8,
    Down 5,
    Down 4,
    Forward 8,
    Down 1,
    Down 8,
    Forward 3,
    Down 4,
    Forward 5,
    Down 5,
    Up 9,
    Forward 1,
    Down 9,
    Down 1,
    Forward 4,
    Forward 9,
    Up 1,
    Forward 4,
    Forward 2,
    Down 9,
    Down 1,
    Forward 1,
    Down 2,
    Forward 2,
    Down 5,
    Up 4,
    Up 7,
    Down 8,
    Forward 3,
    Up 1,
    Down 4,
    Forward 5,
    Up 2,
    Forward 4,
    Forward 2,
    Down 1,
    Forward 4,
    Forward 1,
    Up 5,
    Forward 8,
    Forward 4,
    Forward 1,
    Down 6,
    Down 7,
    Up 4,
    Forward 9,
    Up 6,
    Forward 9,
    Forward 3,
    Forward 2,
    Down 2,
    Forward 7,
    Up 7,
    Forward 7,
    Down 4,
    Down 6,
    Forward 8,
    Up 8,
    Forward 1,
    Forward 3,
    Forward 3,
    Up 8,
    Down 1,
    Up 9,
    Forward 1,
    Up 1,
    Down 7,
    Forward 7,
    Up 5,
    Forward 5,
    Up 9,
    Up 3,
    Forward 2,
    Forward 6,
    Up 1,
    Forward 5,
    Up 1,
    Down 3,
    Down 5,
    Forward 8,
    Up 5,
    Forward 1,
    Down 8,
    Forward 4,
    Down 3,
    Down 1,
    Down 7,
    Forward 7,
    Forward 3,
    Down 4,
    Forward 9,
    Up 5,
    Down 2,
    Forward 4,
    Up 7,
    Up 5,
    Forward 3,
    Down 7,
    Forward 8,
    Up 4,
    Up 2,
    Forward 2,
    Down 9,
    Forward 4,
    Down 5,
    Forward 2,
    Down 9,
    Down 5,
    Up 7,
    Forward 3,
    Down 8,
    Forward 7,
    Forward 9,
    Down 5,
    Forward 2,
    Forward 9,
    Forward 5,
    Down 5,
    Up 4,
    Down 6,
    Down 6,
    Forward 8,
    Forward 5,
    Forward 4,
    Down 5,
    Forward 2,
    Down 8,
    Forward 9,
    Down 1,
    Down 8,
    Down 7,
    Up 9,
    Down 7,
    Down 1,
    Forward 7,
    Forward 9,
    Forward 8,
    Up 2,
    Forward 6,
    Down 3,
    Down 6,
    Up 4,
    Forward 4,
    Forward 5,
    Down 9,
    Down 5,
    Forward 1,
    Down 2,
    Forward 1,
    Down 1,
    Up 1,
    Up 7,
    Up 5,
    Forward 6,
    Forward 3
  ]
